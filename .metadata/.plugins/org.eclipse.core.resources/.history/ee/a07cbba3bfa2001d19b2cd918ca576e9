package DB_Java;

import java.util.*;

import org.bson.Document;
import org.bson.conversions.Bson;

import com.mongodb.*;
import com.mongodb.MongoClient;
import com.mongodb.client.*;
import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;

public class MongoJavaLocal {
	static MongoClient mc = new MongoClient("localhost",27017);
	static MongoDatabase db = mc.getDatabase("Javadb");

	public static void file(String name,int age,int phone,String address) {
		MongoCollection <Document> currcol = db.getCollection("Javacol");
		Bson Name = set("name",name);
		Bson Age = set("age",age);
		Bson Phone = set("phone",phone);
		Bson Address = set("address",address);
		Bson com = combine(Name,Age,Phone,Address);
		
		currcol.insertOne((Document) com);
	}
	
	public static void Crud() {
		Scanner in = new Scanner(System.in);
		// Create document
		MongoCollection <Document> currcol = db.getCollection("Javacol");
		System.out.print("Enter your name : ");
		String name = in.nextLine();
		System.out.print("Enter your age : ");
		int age = in.nextInt();
		System.out.print("Enter your phone number : ");
		int phone = in.nextInt();
		System.out.print("Enter your address : ");
		String address = in.nextLine();
		file(name,age,phone,address);
		
	}

	public static void main(String[] args) throws Exception {
		try {
			mc = new MongoClient("localhost",27017);
			db = mc.getDatabase("Javadb");
			System.out.println("Database connected.");
			ArrayList<String> collections = db.listCollectionNames().into(new ArrayList<>());
			boolean check = collections.contains("Javacol");
			if(check == true) {
				Crud();
			}
			else {
				System.out.println("Collection doesn't exist.");
				db.createCollection("Javacol");
				System.out.println("Collection created successfully.");
				Crud();
				
				mc.close();
			}
		} catch(Exception e) {
			System.out.println("Database connection failed.");
		}
	}

}
