package DB_Java;

import java.util.ArrayList;
import java.util.Set;

import org.bson.Document;

import com.mongodb.DB;
import com.mongodb.MongoClient;
import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;
import com.mongodb.client.MongoIterable;

public class MongoJava2 {
	static MongoClient mc = new MongoClient("localhost",27017);
	static MongoDatabase db = mc.getDatabase("Javadb");

	
	public static void CRUD() {
		MongoCollection <Document> currcol = db.getCollection("Javacol");
	}

	public static void main(String[] args) {
		try {
		System.out.println("Database connected.");
		boolean check = db.listCollectionNames().into(new ArrayList<>()).contains("javacol");
		if(check == true) {
			CRUD();
		}
		else {
			System.out.println("Collection doesn't exist.");
			db.createCollection("Javacol", null);
			System.out.println("Collection created successfully.");
			CRUD();
		}
		mc.close();
		}
		catch(Exception e) {
			System.out.println("Database connection failed.");
		}
	}

}
