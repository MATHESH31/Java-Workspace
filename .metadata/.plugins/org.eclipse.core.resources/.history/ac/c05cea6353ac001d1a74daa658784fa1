package DB_Java;

import java.util.*;
import java.util.regex.*;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;

public class PostgreJava {
	static Scanner in = new Scanner(System.in);
	static Connection c = null;
	
	public static long number() {

		long a = 0;
		try {
			a = in.nextInt();
		}
		catch(Exception e) {
			System.out.print("Please enter a number : ");
			a = number();
		}
		return a;
	}
	
	public static String string() {
		String a = "";
		try {
			a = in.nextLine();
		}
		catch(Exception e) {
			System.out.print("Please enter a string : ");
			a = string();
		}
		return a;
	}

	public static void Operations() throws SQLException {
		while (true) {
			System.out.println(
					"Enter 1 to Insert data.\nEnter 2 to Read data.\nEnter 3 to Update data.\nEnter 4 to Delete data.");
			System.out.print("Enter your choice : ");
			int ent_op = in.nextInt();
			in.nextLine();

			switch (ent_op) {
			case 1:
				System.out.print("Enter id : ");
				int id = (int) number();
				in.nextLine();
				System.out.print("Enter name : ");
				String name = string();
				System.out.print("Enter age : ");
				int Age = (int) number();
				System.out.print("Enter phone : ");
				long phone = number();
				in.nextLine();
				System.out.print("Enter address : ");
				String address = string();

				c.createStatement().executeUpdate("INSERT INTO COMPANY (ID,Name,Age,phone,Address) VALUES ('" + id + "','"
						+ name + "','" + Age + "','" + phone + "','" + address + "');");
				break;

			case 2:
				c.createStatement().executeQuery("SELECT * FROM Company;");
				break;

			case 3:
				
				break;
			
			case 4:
				
				break;
				
			default:
				System.out.println("Please check your input.");
			}

		}
	}

	public static void main(String[] args) {
		try {
			Class.forName("org.postgresql.Driver");
			c = DriverManager.getConnection("jdbc:postgresql://localhost:5432/java_pg", "postgres", "123456");
			System.out.println("Database connected successfully");

			Operations();

		} catch (Exception e) {
			e.printStackTrace();
			System.err.println(e.getClass().getName() + " : " + e.getMessage());
			System.exit(0);
		}

		in.close();
	}
}
